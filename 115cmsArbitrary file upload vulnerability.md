vendor : http://www.115cms.com/


115cms V4.2 installation package ：https://gitee.com/haepic/www.115cms.com

Vulnerability type： V4.2

Recurrence environment：

Windows Server 2019
phpstudy


Vulnerability description：
There is an arbitrary file upload vulnerability in the 15cmsV4.05 web application. loophole http://x.x.x.x/index.php/admin/content/index HTTP/, the allowed suffix for uploading can be set at the basic configuration of the background function website settings, and then the attachment can be uploaded at the content of the content management article. Any file can be uploaded, and the website can be controlled through webshell

Loophole recurrence：
The file upload type and content are not filtered in extend/org/Upload. php
<img width="417" alt="Pasted image 20230310220503" src="https://user-images.githubusercontent.com/58252883/224365382-2bf97ed9-bd35-481b-ad63-86405baa1de6.png">

Add "php" suffix in "Basic Settings" and click Save to upload successfully
<img width="1423" alt="Pasted image 20230310222122" src="https://user-images.githubusercontent.com/58252883/224365485-43ffbbb8-32ed-48da-8979-9be2b07af192.png">
<img width="1499" alt="Pasted image 20230310222141" src="https://user-images.githubusercontent.com/58252883/224365521-0d6e4652-0af8-4333-a390-75da99a71736.png">
<img width="1293" alt="Pasted image 20230310222205" src="https://user-images.githubusercontent.com/58252883/224365545-fa39d198-31aa-4ad7-8014-08b8c79fdf10.png">

Then access the uploaded file “*.php”. Get webshell.


<img width="417" alt="Pasted image 20230310222301" src="https://user-images.githubusercontent.com/58252883/224365569-faeaf838-b4a9-4bac-bdc2-cc130e7c55db.png">
